---
layout: post
title:  "面试总结之数据库"
date:   2016-11-07 15:06:40 
categories: 面试经验
tags: 面试总结 数据库 
excerpt: 面试总结之数据库。
---

* content
{:toc}

## 数据库面试总结

比较基础的就不一一介绍了，这篇主要总结一下事务，索引，锁，数据库两个主要引擎。

关于B+Tree，Mysql优化性能调优，博主水平有限，这些之后再做总结！

---

### 事务

事务是作为一个逻辑单元执行的一系列操作，一个逻辑工作单元必须有四个属性，称为 ACID（原子性、一致性、隔离性和持久性）属性，只有这样才能成为一个事务。

* 原子性：一个事务是一个不可分割的工作单位，事务中包括的诸操作要么都做，要么都不做。

* 一致性：事务必须是使数据库从一个一致性状态变到另一个一致性状态。一致性与原子性是密切相关的。

* 隔离性：一个事务的执行不能被其他事务干扰。即一个事务内部的操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。

* 持久性：持久性也称永久性（permanence），指一个事务一旦提交，它对数据库中数据的改变就应该是永久性的。接下来的其他操作或故障不应该对其有任何影响。

---

### 事务的SQL操作语句

* 开始事务：begin TRANSACTION;

* 提交事务：commit TRANSACTION;

* 回滚事务：rollback TRANSACTION;

---

### 事务的并发问题

一个数据库可能拥有多个访问客户端，这些客户端都可以并发方式访问数据库。数据库中的相同数据可能同时被多个事务访问，如果没有采取必要的隔离措施，就会导致各种并发问题，破坏数据的完整性。这些问题可以归结为5类，包括3类数据读问题脏读、幻象读和不可重复读）以及2类数据更新问题（第一类丢失更新和第二类丢失更新）。

* 脏读：A事务读取B事务尚未提交的更改数据；

* 不可重复读：A事务读取了B事务已经提交的数据，导致两次读不一致；

* 幻想读：A事务读取了B事务新增的数据，幻象读和不可重复读是两个容易混淆 的概念，前者是指读到了其它已经提交事务的新增数据，而后者是指读到了已经提交事 务的更改数据（更改或删除）；

* 第一类丢失更新：A事务撤销时，把已经提交的B事务的更新数据覆盖了；

* 第二类丢失更新：A事务提交时覆盖了B事务提交的数据；

---

### 事务日志

事务日志主要用于记录对事务的更新操作，包括增加，删除，修改

---

## 索引(数据库术语)

在关系数据库中，索引是一种单独的、物理的数对数据库表中一列或多列的值进行排序的一种存储结构，它是某个表中一列或若干列值的集合和相应的指向表中物理标识这些值的数据页的逻辑指针清单。索引的作用相当于图书的目录，可以根据目录中的页码快速找到所需的内容。

索引提供指向存储在表的指定列中的数据值的指针，然后根据您指定的排序顺序对这些指针排序。数据库使用索引以找到特定值，然后顺指针找到包含该值的行。这样可以使对应于表的SQL语句执行得更快，可快速访问数据库表中的特定信息。

当表中有大量记录时，若要对表进行查询，第一种搜索信息方式是全表搜索，是将所有记录一一取出，和查询条件进行一一对比，然后返回满足条件的记录，这样做会消耗大量数据库系统时间，并造成大量磁盘I/O操作；第二种就是在表中建立索引，然后在索引中找到符合查询条件的索引值，最后通过保存在索引中的ROWID（相当于页码）快速找到表中对应的记录。

---

### 常用的索引

* 唯一索引：唯一索引是不允许其中任何两行具有相同索引值的索引。

	当现有数据中存在重复的键值时，大多数数据库不允许将新创建的唯一索引与表一起保存。数据库还可能防止添加将在表中创建重复键值的新数据。
	
	例如，如果在employee表中职员的姓(lname)上创建了唯一索引，则任何两个员工都不能同姓。
	
* 主键索引：数据库表经常有一列或列组合，其值唯一标识表中的每一行。该列称为表的主键。 在数据库关系图中为表定义主键将自动创建主键索引，主键索引是唯一索引的特定类型。

	该索引要求主键中的每个值都唯一。当在查询中使用主键索引时，它还允许对数据的快速访问。
	
* 聚集索引：在聚集索引中，表中行的物理顺序与键值的逻辑（索引）顺序相同。

	一个表只能包含一个聚集索引。
  
  如果某索引不是聚集索引，则表中行的物理顺序与键值的逻辑顺序不匹配。与非聚集索引相比，聚集索引通常提供更快的数据访问速度。 
  
---

### 索引的优缺点

* 索引的优点

    1.通过创建唯一性索引，可以保证数据库表中每一行数据的唯一性。
    
    2.可以大大加快数据的检索速度，这也是创建索引的最主要的原因。
    
    3.可以加速表和表之间的连接，特别是在实现数据的参考完整性方面特别有意义。
    
    4.在使用分组和排序子句进行数据检索时，同样可以显著减少查询中分组和排序的时间。
    
    5.通过使用索引，可以在查询的过程中，使用优化隐藏器，提高系统的性能。
    
* 索引的缺点

    1.创建索引和维护索引要耗费时间，这种时间随着数据量的增加而增加。
    2.索引需要占物理空间，除了数据表占数据空间之外，每一个索引还要占一定的物理空间，如果要建立聚簇索引，那么需要的空间就会更大。
    3.当对表中的数据进行增加、删除和修改的时候，索引也要动态的维护，这样就降低了数据的维护速度。
    
---

### 什么时候应该创建索引？

索引是建立在数据库表中的某些列的上面。在创建索引的时候，应该考虑在哪些列上可以创建索引，在哪些列上不能创建索引。

* 一般来说，应该在这些列上创建索引：

    1.在经常需要搜索的列上，可以加快搜索的速度；
  
    2.在作为主键的列上，强制该列的唯一性和组织表中数据的排列结构；
  
    3.在经常用在连接的列上，这些列主要是一些外键，可以加快连接的速度；
  
    4.在经常需要根据范围进行搜索的列上创建索引，因为索引已经排序，其指定的范围是连续的；
  
    5.在经常需要排序的列上创建索引，因为索引已经排序，这样查询可以利用索引的排序，加快排序查询时间；
  
    6.在经常使用在WHERE子句中的列上面创建索引，加快条件的判断速度。
  
* 不应该创建索引的的这些列具有下列特点：

    1.对于那些在查询中很少使用或者参考的列不应该创建索引。这是因为，既然这些列很少使用到，因此有索引或者无索引，并不能提高查询速度。相反，由于增加了索引，反而降低了系统的维护速度和增大了空间需求。
  
    2.对于那些只有很少数据值的列也不应该增加索引。这是因为，由于这些列的取值很少，例如人事表的性别列，在查询的结果中，结果集的数据行占了表中数据行的很大比例，即需要在表中搜索的数据行的比例很大。增加索引，并不能明显加快检索速度。
  
    3.对于那些定义为text, image和bit数据类型的列不应该增加索引。这是因为，这些列的数据量要么相当大，要么取值很少。
  
    4.当修改性能远远大于检索性能时，不应该创建索引。这是因为，修改性能和检索性能是互相矛盾的。当增加索引时，会提高检索性能，但是会降低修改性能。当减少索引时，会提高修改性能，降低检索性能。
  
* 因此，当修改性能远远大于检索性能时，不应该创建索引。

---



